(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5892:function(r,e,n){"use strict";n.r(e),n.d(e,{default:function(){return F}});var t=n(8527),o=n(9613),i=n(2024),s=n(9042),a=n(1440),c=n(7294),l=n(5893);function u(r,e){var n="undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=function(r,e){if(!r)return;if("string"===typeof r)return d(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(r);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(r,e)}(r))||e&&r&&"number"===typeof r.length){n&&(r=n);var t=0,o=function(){};return{s:o,n:function(){return t>=r.length?{done:!0}:{done:!1,value:r[t++]}},e:function(r){throw r},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=n.call(r)},n:function(){var r=n.next();return s=r.done,r},e:function(r){a=!0,i=r},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}function d(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}var h=function(r){var e=r.data,n=r.id,o=(0,c.useRef)(100),i=(0,c.useState)(1),s=i[0],d=i[1],h=(0,c.useState)(!1),f=h[0],m=h[1],b=[];(0,c.useEffect)((function(){if(e){(e.errors||e.response.errors)&&m(!0);var r=Object.keys(e).reduce((function(r,n){return"errors"!==n&&"dateAndTime"!==n&&"totalDuration"!==n&&"trace_id"!==n&&"response"!==n?(o.current=Math.max(o.current,e[n]),r+e[n]):r}),0);d(r)}}),[e]);var x,p=["orange.300","orange.400","orange.500","orange.600","orange.700"],g=["red.500","red.600","red.700","red.800","red.900"],j=0,v=Object.keys(e).filter((function(r){return"dateAndTime"!==r&&"totalDuration"!==r&&"trace_id"!==r&&"errors"!==r&&"response"!==r})),y=u(v);try{for(y.s();!(x=y.n()).done;){var k=x.value,C=j%5;o.current=Math.max(o.current,e[k]),b.push((0,l.jsx)(a.u,{hasArrow:!0,label:"".concat(k,": ").concat(e[k],"ms"),bg:"gray.300",color:"black",children:(0,l.jsx)(t.xu,{id:j.toString(),w:e[k]/s,minWidth:"100px",backgroundColor:!0===f?g[C]:p[C],p:1,fontSize:".6rem",color:"white",fontWeight:"bold",h:"1.5rem",_hover:{backgroundColor:"blue.800"},ml:0===j?"1rem":"0",borderTopLeftRadius:0===j?"1rem":0,borderBottomLeftRadius:0===j?"1rem":0,borderTopRightRadius:j===v.length-1?"1rem":0,borderBottomRightRadius:j===v.length-1?"1rem":0,children:k},j.toString())},j.toString())),j++}}catch(w){y.e(w)}finally{y.f()}return(0,l.jsxs)(t.kC,{alignItems:"center",children:[(0,l.jsx)(t.kC,{id:n,justifyContent:"center",fontSize:".5rem",fontWeight:"700",borderRadius:"1rem",minWidth:"160px",maxWidth:"160px",textAlign:"center",color:"white",children:e.trace_id}),b]})},f=function(r){for(var e,n=r.data,o=[],i="",s=0,a=Object.keys(n);s<a.length;s++){var c=a[s];if("trace_id"!==c)if("errors"===c)i+=JSON.stringify(n[c]);else if("response"===c)n[c].data&&(e=JSON.stringify(n[c].data)),n[c].errors&&(i+=JSON.stringify(n[c].errors));else if("dateAndTime"===c){var u=o[0];o[0]=(0,l.jsx)(t.kC,{children:(0,l.jsxs)("p",{children:[(0,l.jsx)("b",{children:"TIMESTAMP:"})," ",n[c]]})}),o.push(u)}else if("totalDuration"===c){var d=o[1];o[1]=(0,l.jsx)(t.kC,{children:(0,l.jsxs)("p",{children:[(0,l.jsx)("b",{children:"TOTAL DURATION:"})," ",n[c],"ms"]})}),o.push(d)}else o.push((0,l.jsx)(t.kC,{children:(0,l.jsxs)("p",{children:[(0,l.jsxs)("b",{children:[c,":"]})," ",n[c],"ms"]})}))}return o.push((0,l.jsxs)(t.kC,{direction:"column",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("b",{children:"RESULT:"})," ",e]}),i?(0,l.jsxs)("p",{children:[(0,l.jsx)("b",{children:"ERRORS:"})," ",(0,l.jsx)("span",{style:{backgroundColor:"#63171B"},children:i})]}):null]})),(0,l.jsx)(t.kC,{direction:"column",backgroundColor:"rgb(255,255,255,.1)",p:"1rem",fontSize:".8rem",color:"white",mt:"1rem",children:o})},m=function(){var r=(0,o.C)((function(r){return r})).data.rawdata.map((function(r,e){return(0,l.jsxs)(i.Qd,{w:"100%",border:"none",children:[(0,l.jsx)("h1",{children:(0,l.jsx)(i.KF,{children:(0,l.jsx)(t.xu,{width:"100%",children:(0,l.jsx)(h,{id:e.toString(),data:r})})})}),(0,l.jsx)(i.Hk,{pb:4,children:(0,l.jsx)(f,{data:r})})]},e.toString())}));return(0,l.jsxs)(t.kC,{p:"3rem",w:"100%",borderRadius:"1rem",backgroundColor:"blue.500",direction:"column",mb:"3rem",children:[(0,l.jsx)(s.iA,{mb:"1rem",children:(0,l.jsx)(s.hr,{children:(0,l.jsxs)(s.Tr,{children:[(0,l.jsx)(s.Th,{textAlign:"center",width:"200px",color:"blue.800",children:"Trace ID"}),(0,l.jsx)(s.Th,{textAlign:"center",color:"blue.800",children:"Duration Metrics"})]})})}),(0,l.jsx)(t.kC,{direction:"column",alignItems:"flex-start",children:(0,l.jsx)(i.UQ,{w:"100%",allowMultiple:!0,allowToggle:!0,children:r})})]})},b=n(1163),x=n(8598),p=n(3328);function g(r,e){var n="undefined"!==typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=function(r,e){if(!r)return;if("string"===typeof r)return j(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);"Object"===n&&r.constructor&&(n=r.constructor.name);if("Map"===n||"Set"===n)return Array.from(r);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(r,e)}(r))||e&&r&&"number"===typeof r.length){n&&(r=n);var t=0,o=function(){};return{s:o,n:function(){return t>=r.length?{done:!0}:{done:!1,value:r[t++]}},e:function(r){throw r},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,a=!1;return{s:function(){n=n.call(r)},n:function(){var r=n.next();return s=r.done,r},e:function(r){a=!0,i=r},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw i}}}}function j(r,e){(null==e||e>r.length)&&(e=r.length);for(var n=0,t=new Array(e);n<e;n++)t[n]=r[n];return t}p.kL.register(p.ZL,p.vn,p.De,p.Dx,p.u);var v=function(){var r=(0,c.useRef)(null),e=(0,b.useRouter)(),n={onClick:function(r,n){!function(r){var n="/#"+r;e.push(n)}(n[0]?n[0].index:null)},barThickness:10,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgb(178, 190, 219)",titleColor:"#1A365D",bodyColor:"#1A365D",callbacks:{label:function(r){return"Total Duration: "+r.parsed.y+"ms"}}}},maintainAspectRatio:!1,onResize:function(r,e){r.update()},scales:{x:{grid:{display:!1},position:"bottom",stacked:!0,ticks:{callback:function(r){return""},color:"#8e94ab"}},y:{grid:{display:!1},ticks:{callback:function(r,e,n){return r+"ms"},color:"white"}}}},i=(0,c.useState)({labels:[],datasets:[{id:1,label:"Traces",data:[],backgroundColor:[]}]}),s=i[0],a=i[1],u=(0,o.C)((function(r){return r}));return(0,c.useEffect)((function(){if(u){var e,n={labels:[],datasets:[{id:1,label:"Traces",data:[],backgroundColor:[]}]},t=g(u.data.rawdata);try{for(t.s();!(e=t.n()).done;){var o=e.value;o&&(n.labels.push(o.trace_id),n.datasets[0].data.push(o.totalDuration),o.errors||o.response.errors?n.datasets[0].backgroundColor.push("#63171B"):n.datasets[0].backgroundColor.push("white"))}}catch(i){t.e(i)}finally{t.f()}a(n),r.current.update()}}),[u]),(0,l.jsx)(t.kC,{w:"100%",h:"350px",margin:"0",mb:"1rem",borderRadius:"1rem",padding:"2rem",pt:"3rem",backgroundColor:"blue.700",justifyContent:"center",alignItems:"center",children:(0,l.jsx)(x.$Q,{data:s,options:n,ref:r},e.route)},e.route)},y=function(){return(0,l.jsxs)(t.kC,{w:"100%",flexFlow:"row wrap",justifyContent:"space-between",children:[(0,l.jsx)(v,{}),(0,l.jsx)(m,{})]})},k=function(r){var e=r.max,n=r.thisNum,o=r.name,i=r.label,s=n===e?"100%":(Number(n)/e*100).toString()+"%";return i.length&&(n=Number(n).toFixed(2)),(0,l.jsxs)(t.kC,{direction:"column",mt:"1rem",children:[(0,l.jsx)(t.X6,{size:"xs",mb:".5rem",children:o}),(0,l.jsx)(t.kC,{direction:"row",h:"1.5rem",w:"100%",backgroundColor:"white",borderRadius:"1rem",children:(0,l.jsx)(a.u,{hasArrow:!0,label:"".concat(o,": ").concat(n," ").concat(i),bg:"gray.300",color:"black",children:(0,l.jsx)(t.xu,{w:s,h:"100%",backgroundColor:"orange.400",borderRadius:"1rem"})})})]})},C=function(r,e){var n=[],o=[],i=[],s=[],a=[];for(var c in r)"RootQ"==c.slice(0,5)?(o.push([c,r[c]]),i.push([c,e[c]])):(s.push([c,r[c]]),a.push([c,e[c]]));for(var u=[o,i,s,a].map((function(r){return r.sort((function(r,e){return e[1]-r[1]})).splice(5)})),d=[[1,1],[2,1],[1,2],[2,2]],h=["Top 5 Root Operations by Average Duration","Top 5 Root Operations by Invocation Count","Top 5 Resolvers by Average Duration","Top 5 Resolvers by Invocation Count"],f=function(){var r="",e=u.shift(),o=d.shift(),i=h.shift();o&&1===o[0]&&(r="ms");var s=e.map((function(n,t){return(0,l.jsx)(k,{max:e[0][1],thisNum:n[1],name:n[0],label:r},t.toString())}));n.push((0,l.jsxs)(t.P4,{rowStart:o[0],colStart:o[1],backgroundColor:"blue.700",p:"1.5rem",display:"flex",flexDirection:"column",h:"1fr",borderRadius:"1rem",children:[(0,l.jsx)(t.X6,{size:"sm",mb:"1rem",children:i}),(0,l.jsx)("hr",{}),s]}))};u.length;)f();return n},w=function(){var r=(0,o.C)((function(r){return r.data})),e=r.averages,n=r.count,i=C(e,n);return(0,l.jsx)(t.rj,{gap:4,templateColumns:"repeat(2, 1fr)",children:i})},S=function(){var r,e=(0,o.C)((function(r){return r})).data,n=[],t=0,i=0;for(var a in r=0===i?0:t/i,e.averages)n.push((0,l.jsxs)(s.Tr,{children:[(0,l.jsx)(s.Td,{color:"#F7F7F7",children:a}),(0,l.jsxs)(s.Td,{isNumeric:!0,color:"#F7F7F7",children:[e.averages[a].toFixed(2)," ",(0,l.jsx)("i",{children:"ms"})]})]})),t+=e.averages[a]*Number(e.count[a]),i+=Number(e.count[a]);return r=t/i,(0,l.jsxs)(s.iA,{variant:"simple",color:"#F7F9FA",backgroundColor:"blue.700",borderRadius:"1rem",children:[(0,l.jsx)(s.hr,{children:(0,l.jsxs)(s.Tr,{children:[(0,l.jsx)(s.Th,{borderTopLeftRadius:"1rem",backgroundColor:"blue.500",pt:"1rem",pb:"1rem",color:"FEFEFE",fontSize:"1rem",children:"Resolver Name"}),(0,l.jsx)(s.Th,{borderTopRightRadius:"1rem",backgroundColor:"blue.500",pt:"1rem",pb:"1rem",color:"FEFEFE",isNumeric:!0,fontSize:"1rem",children:"Average Duration"})]})}),(0,l.jsx)(s.p3,{children:n}),(0,l.jsx)(s.$R,{children:(0,l.jsxs)(s.Tr,{children:[(0,l.jsx)(s.Th,{pt:"1rem",pb:"1rem",color:"FEFEFE",fontSize:"1rem",children:"Average Execution Time"}),(0,l.jsxs)(s.Td,{pt:"1rem",pb:"1rem",color:"FEFEFE",fontSize:"1rem",isNumeric:!0,children:[r.toFixed(2)," ",(0,l.jsx)("i",{children:"ms"})]})]})})]})},T=n(5193);p.kL.register(p.vn,p.ZL,p.f$,p.Dx,p.uw);var A=function(){var r=(0,c.useState)("live"),e=r[0],n=r[1];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(T.hE,{mt:".4rem",mb:"2rem",isAttached:!0,pos:"-webkit-sticky",children:[(0,l.jsx)(T.zx,{colorScheme:"blue",onClick:function(){return n("live")},isActive:"live"===e,children:"Live Tracing Feed"}),(0,l.jsx)(T.zx,{colorScheme:"blue",onClick:function(){return n("res")},isActive:"res"===e,children:"Resolver Average View"}),(0,l.jsx)(T.zx,{colorScheme:"blue",onClick:function(){return n("in")},isActive:"in"===e,children:"Insights"})]}),(0,l.jsx)(t.kC,{direction:"column",children:"live"===e?(0,l.jsx)(y,{}):"res"===e?(0,l.jsx)(S,{}):(0,l.jsx)(w,{})})]})},R=function(r){var e,n,o=r.size,i=r.text;switch(o){case"lg":e="2.5em",n="400px";break;case"md":e="2em",n="300px";break;case"sm":e="1.5em",n="500px"}return(0,l.jsxs)(t.kC,{fontSize:e,w:n,mb:"1rem",alignItems:"center",children:[(0,l.jsx)(t.xv,{fontFamily:"serif",fontSize:"3rem",mr:".8rem",children:"trace "}),(0,l.jsx)(t.xv,{fontWeight:"thin",fontSize:"2rem",children:"|"}),(0,l.jsx)(t.xv,{fontWeight:"thin",color:"blue.100",ml:".8rem",pt:".6rem",children:i})]})},F=function(){return(0,l.jsxs)(t.kC,{direction:"column",w:"90%",h:"100vh",p:"1.5rem",m:"1rem",overflowY:"scroll",children:[(0,l.jsx)(R,{size:"sm",text:"Dashboard"}),(0,l.jsx)(A,{})]})}},5301:function(r,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5892)}])}},function(r){r.O(0,[570,365,774,888,179],(function(){return e=5301,r(r.s=e);var e}));var e=r.O();_N_E=e}]);