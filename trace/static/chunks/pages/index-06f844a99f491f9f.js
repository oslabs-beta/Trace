(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{2695:function(e,r,t){"use strict";var n=t(8527),o=t(7294),i=t(949),a=t(5893);r.Z=function(e){var r,t,c=e.size,s=e.text,l=(0,i.If)(),u=l.colorMode,d=(l.toggleColorMode,(0,o.useState)("blue.100")),f=d[0],h=d[1];switch((0,o.useEffect)((function(){h("light"===u?"blue.900":"blue.100")}),[u]),c){case"lg":r="2.5em",t="400px";break;case"md":r="2em",t="300px";break;case"sm":r="1.5em",t="500px"}return(0,a.jsxs)(n.kC,{fontSize:r,w:t,mb:"1rem",alignItems:"center",children:[(0,a.jsx)(n.xv,{fontFamily:"serif",fontSize:"3rem",mr:".8rem",children:"trace "}),(0,a.jsx)(n.xv,{fontWeight:"thin",fontSize:"2rem",children:"|"}),(0,a.jsx)(n.xv,{fontWeight:"thin",color:f,ml:".8rem",pt:".6rem",children:s})]})}},3564:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return R}});var n=t(8527),o=t(9613),i=t(2024),a=t(9042),c=t(1440),s=t(7294),l=t(5893);function u(e,r){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(!e)return;if("string"===typeof e)return d(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return d(e,r)}(e))||r&&e&&"number"===typeof e.length){t&&(e=t);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(c)throw i}}}}function d(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var f=function(e){var r=e.data,t=e.id,o=100,i=(0,s.useState)(1),a=i[0],d=i[1],f=(0,s.useState)(!1),h=f[0],m=f[1],x=[];(0,s.useEffect)((function(){if(r){(r.errors||r.response.errors)&&m(!0);var e=Object.keys(r).reduce((function(e,t){return"errors"!==t&&"dateAndTime"!==t&&"totalDuration"!==t&&"trace_id"!==t&&"response"!==t?(o=Math.max(o,r[t]),e+r[t]):e}),0);d(e)}}),[r]);var b,p=["orange.300","orange.400","orange.500","orange.600","orange.700"],g=["red.500","red.600","red.700","red.800","red.900"],j=0,v=Object.keys(r).filter((function(e){return"dateAndTime"!==e&&"totalDuration"!==e&&"trace_id"!==e&&"errors"!==e&&"response"!==e})),y=u(v);try{for(y.s();!(b=y.n()).done;){var k=b.value;5===j&&(j=0),o=Math.max(o,r[k]),x.push((0,l.jsx)(c.u,{hasArrow:!0,label:"".concat(k,": ").concat(r[k],"ms"),bg:"gray.300",color:"black",children:(0,l.jsx)(n.xu,{id:j.toString(),w:r[k]/a,minWidth:"100px",backgroundColor:!0===h?g[j]:p[j],p:1,fontSize:".6rem",color:"white",fontWeight:"bold",h:"1.5rem",_hover:{backgroundColor:"blue.800"},ml:0===j?"1rem":"0",borderTopLeftRadius:0===j?"1rem":0,borderBottomLeftRadius:0===j?"1rem":0,borderTopRightRadius:j===v.length-1?"1rem":0,borderBottomRightRadius:j===v.length-1?"1rem":0,children:k},j.toString())},j.toString())),j++}}catch(w){y.e(w)}finally{y.f()}return(0,l.jsxs)(n.kC,{alignItems:"center",children:[(0,l.jsx)(n.kC,{id:t,justifyContent:"center",fontSize:".5rem",fontWeight:"700",borderRadius:"1rem",minWidth:"160px",maxWidth:"160px",textAlign:"center",color:"white",children:r.trace_id}),x]})},h=function(e){for(var r,t=e.data,o=[],i="",a=0,c=Object.keys(t);a<c.length;a++){var s=c[a];if("trace_id"!==s)if("errors"===s)i+=JSON.stringify(t[s]);else if("response"===s)t[s].data&&(r=JSON.stringify(t[s].data)),t[s].errors&&(i+=JSON.stringify(t[s].errors));else if("dateAndTime"===s){var u=o[0];o[0]=(0,l.jsx)(n.kC,{children:(0,l.jsxs)("p",{children:[(0,l.jsx)("b",{children:"TIMESTAMP:"})," ",t[s]]})}),o.push(u)}else if("totalDuration"===s){var d=o[1];o[1]=(0,l.jsx)(n.kC,{children:(0,l.jsxs)("p",{children:[(0,l.jsx)("b",{children:"TOTAL DURATION:"})," ",t[s],"ms"]})}),o.push(d)}else o.push((0,l.jsx)(n.kC,{children:(0,l.jsxs)("p",{children:[(0,l.jsxs)("b",{children:[s,":"]})," ",t[s],"ms"]})}))}return o.push((0,l.jsxs)(n.kC,{direction:"column",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("b",{children:"RESULT:"})," ",r]}),i?(0,l.jsxs)("p",{children:[(0,l.jsx)("b",{children:"ERRORS:"})," ",(0,l.jsx)("span",{style:{backgroundColor:"#63171B"},children:i})]}):null]})),(0,l.jsx)(n.kC,{direction:"column",backgroundColor:"rgb(255,255,255,.1)",p:"1rem",fontSize:".8rem",color:"white",mt:"1rem",children:o})},m=function(){var e=(0,o.C)((function(e){return e})).data.rawdata.map((function(e,r){return(0,l.jsxs)(i.Qd,{w:"100%",border:"none",children:[(0,l.jsx)("h1",{children:(0,l.jsx)(i.KF,{children:(0,l.jsx)(n.xu,{width:"100%",children:(0,l.jsx)(f,{id:r.toString(),data:e})})})}),(0,l.jsx)(i.Hk,{pb:4,children:(0,l.jsx)(h,{data:e})})]},r.toString())}));return(0,l.jsxs)(n.kC,{p:"3rem",w:"100%",borderRadius:"1rem",backgroundColor:"blue.500",direction:"column",mb:"3rem",children:[(0,l.jsx)(a.iA,{mb:"1rem",children:(0,l.jsx)(a.hr,{children:(0,l.jsxs)(a.Tr,{children:[(0,l.jsx)(a.Th,{textAlign:"center",width:"200px",color:"blue.800",children:"Trace ID"}),(0,l.jsx)(a.Th,{textAlign:"center",color:"blue.800",children:"Duration Metrics"})]})})}),(0,l.jsx)(n.kC,{direction:"column",alignItems:"flex-start",children:(0,l.jsx)(i.UQ,{w:"100%",allowMultiple:!0,allowToggle:!0,children:e})})]})},x=t(1163),b=t(8598),p=t(3328);function g(e,r){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(!e)return;if("string"===typeof e)return j(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return j(e,r)}(e))||r&&e&&"number"===typeof e.length){t&&(e=t);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(c)throw i}}}}function j(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}p.kL.register(p.ZL,p.vn,p.De,p.Dx,p.u);var v=function(){var e=(0,s.useRef)(null),r=(0,x.useRouter)(),t={labels:[],datasets:[{id:1,label:"Traces",data:[],backgroundColor:[]}]},i={onClick:function(e,t){!function(e){var t="/#"+e;r.push(t)}(t[0]?t[0].index:null)},barThickness:10,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgb(178, 190, 219)",titleColor:"#1A365D",bodyColor:"#1A365D",callbacks:{label:function(e){return"Total Duration: "+e.parsed.y+"ms"}}}},maintainAspectRatio:!1,onResize:function(e,r){e.update()},scales:{x:{grid:{display:!1},position:"bottom",stacked:!0,ticks:{callback:function(e){return""},color:"#8e94ab"}},y:{grid:{display:!1},ticks:{callback:function(e,r,t){return e+"ms"},color:"white"}}}},a=(0,s.useState)(t),c=a[0],u=a[1],d=(0,o.C)((function(e){return e}));return(0,s.useEffect)((function(){if(d){var r,n=g(d.data.rawdata);try{for(n.s();!(r=n.n()).done;){var o=r.value;o&&(t.labels.push(o.trace_id),t.datasets[0].data.push(o.totalDuration),o.errors||o.response.errors?t.datasets[0].backgroundColor.push("#63171B"):t.datasets[0].backgroundColor.push("white"))}}catch(i){n.e(i)}finally{n.f()}u(t),e.current.update()}}),[d]),(0,l.jsx)(n.kC,{w:"100%",h:"350px",margin:"0",mb:"1rem",borderRadius:"1rem",padding:"2rem",pt:"3rem",backgroundColor:"blue.700",justifyContent:"center",alignItems:"center",children:(0,l.jsx)(b.$Q,{data:c,options:i,ref:e},r.route)},r.route)},y=function(){return(0,l.jsxs)(n.kC,{w:"100%",flexFlow:"row wrap",justifyContent:"space-between",children:[(0,l.jsx)(v,{}),(0,l.jsx)(m,{})]})},k=t(5193);p.kL.register(p.vn,p.ZL,p.f$,p.Dx,p.uw);var w=function(){var e=(0,s.useState)("live"),r=e[0],t=e[1];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(k.hE,{mt:".4rem",mb:"2rem",isAttached:!0,pos:"-webkit-sticky",children:[(0,l.jsx)(k.zx,{colorScheme:"blue",onClick:function(){return t("live")},isActive:"live"===r,children:"Live Tracing Feed"}),(0,l.jsx)(k.zx,{colorScheme:"blue",onClick:function(){return t("res")},isActive:"res"===r,children:"Resolver Average View"})]}),(0,l.jsx)(n.kC,{direction:"column",children:"live"===r?(0,l.jsx)(y,{}):"root"===r?(0,l.jsx)("p",{children:"Sort By Root Operation"}):(0,l.jsx)("p",{children:"Sort by Resolver"})})]})},C=t(2695),S=t(9569),A=t(480),T=t(2488),R=function(){var e=(0,s.useState)(null),r=e[0],t=e[1];(0,s.useEffect)((function(){fetch("/api/socketio").finally((function(){var e=(0,T.ZP)();e.on("connect",(function(){console.log("index.tsx: connected")})),e.on("data",(function(e){t(e)})),e.on("disconnect",(function(){console.log("index.tsx: disconnect")}))}))}),[]);var i=(0,o.T)(),a=(0,S.DE)(A,i).updateDataActionCreator;return(0,s.useEffect)((function(){null!==r&&(console.log("new data updated"),a(r))}),[r]),(0,l.jsxs)(n.kC,{direction:"column",w:"90%",h:"100vh",p:"1.5rem",m:"1rem",overflowY:"scroll",children:[(0,l.jsx)(C.Z,{size:"sm",text:"Dashboard"}),(0,l.jsx)(w,{})]})}},5301:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(3564)}])}},function(e){e.O(0,[570,402,774,888,179],(function(){return r=5301,e(e.s=r);var r}));var r=e.O();_N_E=r}]);